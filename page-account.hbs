<!DOCTYPE html>
<html lang="{{@site.locale}}" data-theme="{{@custom.default_theme}}">

   <head>
        {{!-- Basic meta - advanced meta is output with {ghost_head} below --}}
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>{{meta_title}}</title>

        {{!-- Dark Mode Script --}}
        {{#match @custom.default_theme "=" 'only dark'}}
            <script>
                localStorage.removeItem('data-theme');
            </script>
        {{else match @custom.default_theme "=" 'only light'}}
            <script>
                localStorage.removeItem('data-theme');
            </script>
        {{else match @custom.default_theme "=" 'system'}}
            <script>
                const rootElement = document.querySelector("html[data-theme]");
                const systemTheme = window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';

                rootElement.setAttribute('data-theme', systemTheme);
                localStorage.setItem('data-theme', systemTheme);
            </script>
        {{else}}
            <script>
                const rootElement = document.querySelector("html[data-theme]");
                const savedTheme = localStorage.getItem('data-theme');

                if (savedTheme) {
                    rootElement.setAttribute('data-theme', savedTheme);
                } else {
                    localStorage.setItem('data-theme', rootElement.getAttribute('data-theme'));
                }
            </script>
        {{/match}}

        {{!-- Loading Fonts, Fonts Variables Declarations --}}
        {{>font-pairings}}

        {{!-- Styles --}}
        <link rel="stylesheet" href="{{asset "built/main.css"}}">

        {{!-- This tag outputs all your advanced SEO meta, structured data, and other important settings,
        it should always be the last tag before the closing head tag --}}
        {{ghost_head}}
    </head>

     <body class="account-page theme-newsroom">
        {{!-- Website's Header --}}
        {{>header/header-layout headerClassName=" account-page__header"}}

        <main class="page">
            <div class="page-container">
                {{>breadcrumbs classNames=" page__breadcrumbs"}}
                <div class="account">
                    <div class="account__header">
                        {{#if @member.paid}}
                            {{#foreach @member.subscriptions}}
                                {{#if avatar_image}}
                                    <picture>
                                        <source 
                                        srcset="{{img_url avatar_image size="150" format="webp"}} 150w" 
                                        sizes="80px"  type="image/webp">
                                        <img class="account__image" 
                                        srcset="{{img_url avatar_image size="150"}} 150w" 
                                        sizes="80px" 
                                        src="{{img_url avatar_image size="150"}}"
                                        alt="{{@member.name}} {{t "Profile image"}}">
                                    </picture>
                                {{else}}
                                    <div class="account__image account__image--default">
                                        {{>icons/author-default-icon}}
                                    </div>
                                {{/if}}
                            {{/foreach}}
                        {{else}}
                            <div class="account__image account__image--default">
                                {{>icons/author-default-icon}}
                            </div>
                        {{/if}}
                        <button aria-label="{{t "Log Out"}}" class="account__logout-btn" data-members-signout>
                            {{>icons/logout-icon}}
                            <span>{{t "Log Out"}}</span>
                        </button>
                    </div>
                    <span class="account__name">{{@member.name}}</span>
                    {{#if @member.paid}}
                        {{#foreach @member.subscriptions}}
                            <p class="account__desc">
                                {{t "Hey"}}, {{@member.firstname}}! {{t "You have an"}} <strong>{{status}} {{plan.nickname}}</strong> {{t "account with access to all areas. Get in touch if you have any problems or need some help getting things updated, and thanks for subscribing."}}
                            </p>
                        {{/foreach}}
                    {{else}}
                        <p class="account__desc">
                            {{t "Hey"}}, {{@member.firstname}}! {{t "You have an active free account. Get in touch if you have any problems or need some help getting things updated, and thanks for subscribing."}}
                        </p>
                    {{/if}}
                    <button aria-label="{{t "Account Settings"}}" class="account__settings" data-portal="account">
                        {{>icons/settings-icon}}
                        <span>{{t "Account Settings"}}</span>
                    </button>
                    <div class="account-info">
                        <div class="account-info__row">
                            <div class="account-info-item">
                                <span class="account-info-item__name">{{t "Email Address"}}</span>
                                <span class="account-info-item__value">{{@member.email}}</span>
                            </div>
                            <div class="account-info-item">
                                <span class="account-info-item__name">{{t "Your Plan"}}</span>
                                <span class="account-info-item__value">{{#if @member.paid}}{{#foreach @member.subscriptions}}{{plan.nickname}}{{/foreach}}{{else}}{{t "Free"}}{{/if}}</span>
                            </div>
                        </div>
                        {{#if @member.paid}}
                            {{#foreach @member.subscriptions}}
                            <div class="account-info__row">
                                <div class="account-info-item">
                                    <span class="account-info-item__name">{{t "Card"}}</span>
                                    <div class="account-info-item__value">
                                        {{>icons/dots-icon}}
                                        {{default_payment_card_last4}}
                                    </div>
                                </div>
                                <div class="account-info-item">
                                    <span class="account-info-item__name">{{t "Next Bill Date"}}</span>
                                    <span class="account-info-item__value">{{date current_period_end format="DD MMMM YYYY"}}</span>
                                </div>
                            </div>
                            {{/foreach}}
                        {{/if}}
                    </div>
                    {{#if @member.paid}}
                    <div class="account__edit-btn">
                        {{>button btnType="editBilling" btnText="Edit Billing Info"}}
                        {{#foreach @member.subscriptions}} 
                            {{cancel_link class="cancel-subscription-btn"}}  
                        {{/foreach}}
                    </div>
                    {{/if}}
                </div>
            </div>
        </main>

        {{!-- Website's Footer --}}
        {{>footer}}

        {{!-- Scripts --}}
        <script src="{{asset 'built/main.js'}}" defer></script>

        {{!-- Ghost outputs required functional scripts with this tag - it should always be the last thing before the closing body tag --}}
        {{ghost_foot}}
    </body>
</html>


